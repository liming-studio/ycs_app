{"version":3,"sources":["uni-app:///main.js","webpack:////Users/kongzi/code_person/ycs_app_v2/pages/login/index.vue?1f27","webpack:////Users/kongzi/code_person/ycs_app_v2/pages/login/index.vue?10a4","webpack:////Users/kongzi/code_person/ycs_app_v2/pages/login/index.vue?23ad","webpack:////Users/kongzi/code_person/ycs_app_v2/pages/login/index.vue?57c8","uni-app:///pages/login/index.vue"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","data","formData","loginType","phone","password","captcha","captchaBtnText","checkAgreement","btnDisabled","onLoad","methods","changeLoginType","changePhone","changePassword","changeCaptcha","codeChange","getCode","uni","title","setTimeout","getCaptcha","url","res","validateForm","submit","login","method","key","toForgetPassword","toRegister"],"mappings":";;;;;;;;;;;;;AAAA;AAGA;AACA;AAHA;AACAA,EAAE,CAACC,iCAAiC,GAAGC,mBAAmB;AAG1DC,UAAU,CAACC,cAAI,CAAC,C;;;;;;;;;;;;;ACLhB;AAAA;AAAA;AAAA;AAAA;AAAkH;AAClH;AACyD;AACL;;;AAGpD;AAC6M;AAC7M,gBAAgB,iNAAU;AAC1B,EAAE,2EAAM;AACR,EAAE,gFAAM;AACR,EAAE,yFAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,oFAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACtBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA,aAAa,iSAEN;AACP,KAAK;AACL;AACA,aAAa,+TAEN;AACP,KAAK;AACL;AACA,aAAa,uSAEN;AACP,KAAK;AACL;AACA,aAAa,iSAEN;AACP,KAAK;AACL;AACA,aAAa,6SAEN;AACP,KAAK;AACL;AACA,aAAa,iSAEN;AACP,KAAK;AACL;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;AC/DA;AAAA;AAAA;AAAA;AAAozB,CAAgB,myBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;ACoHx0B;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;eAEA;EACAC;IACA;MACAC;QACAC;QACAC;QACAC;QACAC;MACA;MACAC;MAAA;MACAC;MAAA;MACAC;IACA;EACA;EACAC;IACA;IACA;IACA;IACA;IACA;EAAA,CACA;EACAC;IACA;IACAC;MACA;MACA;MACA;IACA;IACA,oBACAC;MACA;IACA;IACAC;MACA;IACA;IACAC;MACA;IACA;IACA,yBACAC;MACA;QACA;MACA;QACA;MACA;IACA;IACAC;MAAA;MACA;MACA;QAAAC;QAAA;MAAA;MACA;QAAAA;QAAA;MAAA;MACA;QAAAA;QAAA;MAAA;MACA;MACAA;QAAAC;MAAA;MACA;MACAC;QACAF;QACAA;QACA;MACA;IACA;IACAG;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA;gBAAA,OACA;kBAAAC;kBAAArB;oBAAAG;kBAAA;gBAAA;cAAA;gBAAAmB;gBACA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IACA;IACA;IACA;IACAC;MACA;QAAAN;QAAA;MAAA;MACA;QAAAA;QAAA;MAAA;MACA;IACA;IACA;IACAO;MACA;QACAP;UAAAC;QAAA;QACA;QACA;MACA;IACA;IACA;IACAO;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA;gBAAA,OACA;kBACAC;kBACAL;kBACArB;oBACAE;oBACAC;oBACAC;oBACAC;kBACA;gBACA;cAAA;gBATAiB;gBAUA;kBACAL;kBACA;kBACAA;gBACA;gBACA;kBACAA;oBAAAU;oBAAA3B;kBAAA;kBACAiB;oBAAAU;oBAAA3B;kBAAA;kBACA;kBACA;kBACAmB;oBACAF;oBACAA;oBACA;oBACAA;sBAAAI;oBAAA;kBACA;gBACA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IACA;IACA,aACAO;MACAX;QACAI;MACA;IACA;IACAQ;MACAZ;QACAI;MACA;IACA;EACA;AACA;AAAA,2B","file":"pages/login/index.js","sourcesContent":["import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;\nimport Vue from 'vue'\nimport Page from './pages/login/index.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./index.vue?vue&type=template&id=4586967a&\"\nvar renderjs\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/login/index.vue\"\nexport default component.exports","export * from \"-!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--17-0!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=template&id=4586967a&\"","var components\ntry {\n  components = {\n    uForm: function () {\n      return import(\n        /* webpackChunkName: \"uni_modules/uview-ui/components/u-form/u-form\" */ \"@/uni_modules/uview-ui/components/u-form/u-form.vue\"\n      )\n    },\n    uFormItem: function () {\n      return import(\n        /* webpackChunkName: \"uni_modules/uview-ui/components/u-form-item/u-form-item\" */ \"@/uni_modules/uview-ui/components/u-form-item/u-form-item.vue\"\n      )\n    },\n    uInput: function () {\n      return import(\n        /* webpackChunkName: \"uni_modules/uview-ui/components/u-input/u-input\" */ \"@/uni_modules/uview-ui/components/u-input/u-input.vue\"\n      )\n    },\n    uCode: function () {\n      return import(\n        /* webpackChunkName: \"uni_modules/uview-ui/components/u-code/u-code\" */ \"@/uni_modules/uview-ui/components/u-code/u-code.vue\"\n      )\n    },\n    uButton: function () {\n      return import(\n        /* webpackChunkName: \"uni_modules/uview-ui/components/u-button/u-button\" */ \"@/uni_modules/uview-ui/components/u-button/u-button.vue\"\n      )\n    },\n    uIcon: function () {\n      return import(\n        /* webpackChunkName: \"uni_modules/uview-ui/components/u-icon/u-icon\" */ \"@/uni_modules/uview-ui/components/u-icon/u-icon.vue\"\n      )\n    },\n  }\n} catch (e) {\n  if (\n    e.message.indexOf(\"Cannot find module\") !== -1 &&\n    e.message.indexOf(\".vue\") !== -1\n  ) {\n    console.error(e.message)\n    console.error(\"1. 排查组件名称拼写是否正确\")\n    console.error(\n      \"2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom\"\n    )\n    console.error(\n      \"3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件\"\n    )\n  } else {\n    throw e\n  }\n}\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  if (!_vm._isMounted) {\n    _vm.e0 = function ($event) {\n      _vm.checkAgreement = !_vm.checkAgreement\n    }\n  }\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=script&lang=js&\"","<template>\n  <view class=\"h-screen py-30 relative\">\n    <!-- logo -->\n    <view class=\"w-full h-300 flex-center\">\n\t\t\t<image src=\"/static/logo.png\" class=\"w-70 h-70\" />\n\t\t\t<view class=\"text-3xl text-primary\" style=\" margin-top:-4px\">云畅搜</view>\n\t\t</view>\n\t\t<!-- main -->\n\t\t<view class=\"px-32\">\n\t\t\t<!-- form -->\n\t\t\t<u-form>\n\t\t\t\t<!-- 手机号 -->\n\t\t\t\t<u-form-item>\n\t\t\t\t\t<u-input\n\t\t\t\t\t\tv-model=\"formData.phone\"\n\t\t\t\t\t\ttype=\"number\"\n\t\t\t\t\t\tmaxlength=\"11\"\n\t\t\t\t\t\tplaceholder=\"请输入手机号\"\n\t\t\t\t\t\tborder=\"bottom\"\n\t\t\t\t\t\tclearable\n\t\t\t\t\t\t@change=\"changePhone\"\n\t\t\t\t\t/>\n\t\t\t\t</u-form-item>\n\t\t\t\t<!-- 密码 -->\n\t\t\t\t<u-form-item v-show=\"formData.loginType\">\n\t\t\t\t\t<u-input\n\t\t\t\t\t\tv-model=\"formData.password\"\n\t\t\t\t\t\t:password=\"true\"\n\t\t\t\t\t\tplaceholder=\"请输入密码\"\n\t\t\t\t\t\tborder=\"bottom\"\n\t\t\t\t\t\tclearable\n\t\t\t\t\t\t@change=\"changePassword\"\n\t\t\t\t\t/>\n\t\t\t\t</u-form-item>\n\t\t\t\t<!-- 验证码 -->\n\t\t\t\t<u-form-item v-show=\"!formData.loginType\">\n\t\t\t\t\t<u-input\n\t\t\t\t\t\tv-model=\"formData.captcha\"\n\t\t\t\t\t\ttype=\"number\"\n\t\t\t\t\t\tplaceholder=\"请输入验证码\"\n\t\t\t\t\t\tborder=\"bottom\"\n\t\t\t\t\t\tclearable\n\t\t\t\t\t\t@change=\"changeCaptcha\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<template slot=\"suffix\">\n\t\t\t\t\t\t\t<u-code\n\t\t\t\t\t\t\t\tref=\"uCode\"\n\t\t\t\t\t\t\t\t@change=\"codeChange\"\n\t\t\t\t\t\t\t\tseconds=\"20\"\n\t\t\t\t\t\t\t\tchangeText=\"X秒重新获取\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<u-button\n\t\t\t\t\t\t\t\ttype=\"primary\"\n\t\t\t\t\t\t\t\tsize=\"mini\"\n\t\t\t\t\t\t\t\tshape=\"circle\"\n\t\t\t\t\t\t\t\t@tap=\"getCode\"\n\t\t\t\t\t\t\t\t:text=\"captchaBtnText\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t  </template>\n\t\t\t\t\t</u-input>\n\t\t\t\t</u-form-item>\n\t\t\t</u-form>\n\t\t\t<view class=\"flex items-center justify-between text-gray-500\">\n\t\t\t\t<view @click=\"toForgetPassword\">忘记密码？</view>\n\t\t\t\t<view @click=\"changeLoginType\">\n\t\t\t\t\t<text>{{ formData.loginType ? '使用短信验证码登录' : '使用密码登录' }}</text>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t\t<u-button \n\t\t\t\ttype=\"primary\"\n\t\t\t\ttext=\"登录\" \n\t\t\t\tshape=\"circle\"\n\t\t\t\tclass=\"mt-50\"\n\t\t\t\t:disabled=\"btnDisabled\"\n\t\t\t\t@click=\"submit\"\n\t\t\t/>\n\t\t\t<view class=\"mt-10 text-center text-base\">\n\t\t\t\t<text class=\"text-gray-500\">还没有账号？</text>\n\t\t\t\t<text class=\"text-primary\" @click=\"toRegister\">立即注册</text>\n\t\t\t</view>\n\t\t</view>\n\t\t<!-- 用户协议、隐私协议 -->\n\t\t<view \n\t\t\tclass=\"absolute w-full flex-center\"\n\t\t\tstyle=\"bottom: 50rpx\"\n\t\t>\n\t\t\t<view\n\t\t\t\tclass=\"w-16 h-16 rounded-5xl border-1 border-gray-300 flex-center\"\n\t\t\t\t:class=\"{'bg-primary border-primary': checkAgreement}\"\n\t\t\t\t@click=\"checkAgreement = !checkAgreement\"\n\t\t\t>\n\t\t\t\t<u-icon v-show=\"checkAgreement\" name=\"checkbox-mark\" color=\"#FFFFFF\" size=\"12\"></u-icon>\n\t\t\t</view>\n\t\t\t<view class=\"ml-4 text-sm flex items-cenetr\">\n\t\t\t\t<view class=\"text-gray-300\">已阅读并同意</view>\n\t\t\t\t<navigator \n\t\t\t\t\turl=\"/pages/agreement/index\"\n\t\t\t\t\thover-class=\"none\"\n\t\t\t\t\tclass=\"text-primary\"\n\t\t\t\t>\n\t\t\t\t\t《服务协议》\n\t\t\t\t</navigator>\n\t\t\t\t<view class=\"text-gray-300\">和</view>\n\t\t\t\t<navigator \n\t\t\t\t\turl=\"/pages/privacy/index\"\n\t\t\t\t\thover-class=\"none\"\n\t\t\t\t\tclass=\"text-primary\"\n\t\t\t\t>\n\t\t\t\t\t《隐私政策》\n\t\t\t\t</navigator>\n\t\t\t</view>\n\t\t</view>\n  </view>\n</template>\n\n<script>\nimport { validatePhone } from '@/utils/validate.js'\nimport { Encrypt } from '@/utils/crypto.js'\n\nexport default {\n  data() {\n    return {\n\t\t\tformData: {\n\t\t\t\tloginType: true,\n\t\t\t\tphone: '',\n\t\t\t\tpassword: '',\n        captcha: ''\n\t\t\t},\n\t\t\tcaptchaBtnText: '',\t\t\t// 验证码按钮文字\n\t\t\tcheckAgreement: false,\t// 是否勾选协议\n\t\t\tbtnDisabled: true \t    // 登录按钮禁用状态\n    }\n  },\n\tonLoad() {\n\t\t// if(uni.getStorageSync('token')) {\n\t\t// \tuni.switchTab({\n\t\t// \t\turl:'/pages/index/index'\n\t\t// \t})\n\t\t// }\n\t},\n  methods: {\n\t\t// 切换登录状态\n\t\tchangeLoginType() {\n\t\t\tthis.formData.loginType = !this.formData.loginType\n\t\t\tif(this.formData.loginType) this.formData.captcha = ''\n\t\t\tif(!this.formData.loginType) this.formData.password = ''\n\t\t},\n\t\t/** 输入变化改变按钮禁用状态 **/\n\t\tchangePhone(val) {\n\t\t\tthis.btnDisabled = this.formData.loginType ? !(this.formData.password && val) : !(this.formData.captcha && val)\n\t\t},\n\t\tchangePassword(val) {\n\t\t\tthis.btnDisabled = !(this.formData.phone && val)\n\t\t},\n\t\tchangeCaptcha(val) {\n\t\t\tthis.btnDisabled = !(this.formData.phone && val)\n\t\t},\n\t\t/******** 验证码相关 ********/\n\t\tcodeChange(text) {\n\t\t\tif(text === '重新获取') {\n\t\t\t\tthis.captchaBtnText = '获取验证码'\n\t\t\t} else {\n\t\t\t\tthis.captchaBtnText = text\n\t\t\t}\n\t\t},\n\t\tgetCode() {\n\t\t\t// 拦截一些不合规的情况\n\t\t\tif(!this.formData.phone) { uni.$u.toast('请输入手机号'); return }\n\t\t\tif(!validatePhone(this.formData.phone)) { uni.$u.toast('手机号格式不正确'); return }\n\t\t\tif(!this.$refs.uCode.canGetCode) { uni.$u.toast('倒计时结束后再发送'); return }\n\t\t\t// 模拟向后端请求验证码\n\t\t\tuni.showLoading({ title: '正在获取验证码' })\n\t\t\tthis.getCaptcha(this.formData.phone)\n\t\t\tsetTimeout(() => {\n\t\t\t\tuni.hideLoading()\n\t\t\t\tuni.$u.toast('验证码已发送')\n\t\t\t\tthis.$refs.uCode.start()\n\t\t\t}, 2000)\n\t\t},\n\t\tasync getCaptcha(phone) {\n\t\t\tconst res = await this.$api({ url: '/open/sendCaptcha', data: { phone: phone } })\n\t\t\tif(res.data.code !== 20000) uni.$u.toast(res.data.msg)\n\t\t},\n\t\t/******** 登录相关 ********/\n\t\t// 登录校验\n\t\tvalidateForm() {\n\t\t\tif(!this.checkAgreement) { uni.$u.toast('请阅读并勾选协议'); return }\n\t\t\tif(!validatePhone(this.formData.phone)) { uni.$u.toast('手机号格式不正确'); return }\n\t\t\treturn true\n\t\t},\n\t\t// 提交信息\n\t\tsubmit() {\n\t\t\tif(this.validateForm()) {\n\t\t\t\tuni.showLoading({ title: '登录中' })\n\t\t\t\tthis.btnDisabled = true\n\t\t\t\tthis.login()\n\t\t\t}\n\t\t},\n\t\t// 登录\n\t\tasync login() {\n\t\t\tconst res = await this.$api({ \n\t\t\t\tmethod: 'POST', \n\t\t\t\turl: '/open/login', \n\t\t\t\tdata: {\n\t\t\t\t\tloginType: this.formData.loginType,\n\t\t\t\t\tphone: this.formData.phone,\n\t\t\t\t\tpassword: Encrypt(this.formData.password),\n\t\t\t\t\tcaptcha: this.formData.captcha,\n\t\t\t\t}\n\t\t\t})\n\t\t\tif(res.data.code !== 20000) {\n\t\t\t\tuni.hideLoading()\n\t\t\t\tthis.btnDisabled = false\n\t\t\t\tuni.$u.toast(res.data.msg)\n\t\t\t}\n\t\t\tif (res.data.code == 20000) {\n\t\t\t\tuni.setStorage({ key: 'token', data: res.data.data.token })\n\t\t\t\tuni.setStorage({ key: 'user', data: res.data.data.user })\n\t\t\t\t// uni.setStorage({ key: 'phone', data: res.data.data.mobile })\n\t\t\t\t// uni.setStorage({ key: 'password', data: res.data.data.password })\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tuni.hideLoading()\n\t\t\t\t\tuni.$u.toast('登录成功')\n\t\t\t\t\tthis.btnDisabled = false\n\t\t\t\t\tuni.reLaunch({ url:\"/pages/index/index\"})\n\t\t\t\t}, 200)\n\t\t\t}\n\t\t},\n\t\t/** 跳转啊啊啊 **/\n\t\ttoForgetPassword() {\n\t\t\tuni.navigateTo({\n\t\t\t\turl: '/pages/login/forget'\n\t\t\t})\n\t\t},\n\t\ttoRegister() {\n\t\t\tuni.navigateTo({\n\t\t\t\turl: '/pages/login/register'\n\t\t\t})\n\t\t}\n\t}\n}\n</script>\n"],"sourceRoot":""}